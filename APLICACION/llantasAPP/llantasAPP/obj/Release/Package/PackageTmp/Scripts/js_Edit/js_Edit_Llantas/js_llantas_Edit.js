var $caneca=$(".caneca"),$cajas=$(".caja"),$llantas=$(".llanta"),_kmTrabajoactual=$("#_KmAct")[0].innerText,_placaActual=$("#_PlacaAct")[0].innerText;llantaDraggable($llantas),canecaDoppable($caneca),cajaDroppable($cajas),$(".collapse").on("show.bs.collapse",function(a){var l=a.target.id;$(".collapse").collapse("hide"),$(l).collapse()}),$(".llanta").on("click",function(a){var l=a.target.className,t=$(this);"imgSentido btn"!=l?$(t).attr({"data-toggle":"collapse","aria-expanded":"false"}):$(t).removeAttr("data-toggle","aria-expanded")}),$("#fomrAddllanta").validate({rules:{nllanta:{required:!0}},messages:{nllanta:{required:" Falta # de parte!."}}});var _llantaData=0;function cambio_Sentido(a){var l=$(a).attr("tag");if(0==l){console.log("la llanta cambio de izquierda a derecha");var t=$(a);$(t).attr("src","/Content/medios/right.png"),$(t).attr("tag",1)}if(1==l){console.log("la llanta cambio de derecha a izquierda");t=$(a);return $(t).attr("src","/Content/medios/left.png"),$(t).attr("tag",0),!1}$(".collapse").collapse("hide")}function add_nuevallanta(a){var l=listaLllantas.indexOf(a);if(-1<l){listaLllantas.splice(l,1),$("#inputnllanta").val("");var t=a.split("-")[0],e=a.split("-")[1],n=$('<div id="'+t+'" class="Nllanta llanta btn btn-outline-success"  href="#infoLlanta'+t+'" role="button" tag="Nllanta"><span class="idllanta">'+t+"-"+e+'</span><div class="collapse infoLlanta" id ="infoLlanta'+t+'" ><div class="card card-body" style="padding:0;"><dl class="row" style="margin:0;"><dt class="col-5 marginTituloDesc">Grupo</dt><dd class="col-5 marginDescTtulo">'+e+'</dd><dt class="col-5 marginTituloDesc">Km Instala</dt><dd class="col-5 marginDescTtulo">'+_kmTrabajoactual+"</dd></dl></div></div></div >");$("#nuevallanta").append(n),llantaDraggable($(".llanta")),llantaClick()}}function llantaDraggable(a){$(a).draggable({revert:"invalid",start:function(a,l){$(this).addClass("llanta_dragg")},stop:function(a,l){$(this).removeClass("llanta_dragg")}})}function cajaDroppable(a){$(a).droppable({accept:".llanta",drop:function(a,l){var t=$(this),e=$(l.draggable),n=t.children();"Nllanta"==l.draggable[0].attributes[4].value?(0!=n.length&&remover(n[0]),$(t).append(e.css({left:"0",top:"0"}))):0!=n.length?cambiar(e[0],n[0]):$(t).append($(e).css({left:"0",top:"0"}))}})}function canecaDoppable(a){$(a).droppable({accept:".llanta",drop:function(a,l){$caneca.removeClass("caneca_over"),remover($(l.draggable))},over:function(a,l){$(this).addClass("caneca_over")},out:function(a,l){$(this).removeClass("caneca_over")}})}function remover(a){var l=$(a).detach().css({left:"0",top:"0"});$caneca.append(l),a[0].attributes[4].value="Pl_removed";var t=a[0].children[0].innerText,e=t.split("-")[0],n=t.split("-")[1];desmontarLlanta(_placaActual,e,n,_kmTrabajoactual),console.log("Se removio la llanta "+e+" del grupo "+n)}function desmontarLlanta(a,l,t,e){$.post("/llantas/llantasRemove/",{_placa:a,_llanta:l,_grupo:t,_kmMEdida:e}).done(function(a){$("#modMuestraDesmonta").append(a),$("#modMuestraDesmonta").modal("show")})}function cambiar(a,l){var t=$(a).css({left:"0",top:"0"}),e=$(l).css({left:"0",top:"0"}),n=$(a).parent(),o=$(l).parent();o.append($(t)),n.append($(e)),console.log("Del eje "+n.attr("id")+" al eje "+o.attr("id"))}$("#fomrAddllanta").on("submit",function(a){(a.preventDefault(),$("#fomrAddllanta").validate(),0!=$("#fomrAddllanta").valid())&&(_llantaData<=9&&(add_nuevallanta($("#inputnllanta").val().toUpperCase()),_llantaData+=1))});